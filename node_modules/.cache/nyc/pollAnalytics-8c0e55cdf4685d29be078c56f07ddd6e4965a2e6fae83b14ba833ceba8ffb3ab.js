function cov_1fcz5r7m3d(){var path="C:\\Users\\Rokon\\source\\repos\\SWENG894-Capstone-Project\\controllers\\pollAnalytics.js";var hash="5e37e2acd226cd9951347216acc2e4057461c1a8";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Rokon\\source\\repos\\SWENG894-Capstone-Project\\controllers\\pollAnalytics.js",statementMap:{"0":{start:{line:1,column:11},end:{line:1,column:41}},"1":{start:{line:3,column:22},end:{line:41,column:1}},"2":{start:{line:4,column:19},end:{line:4,column:32}},"3":{start:{line:5,column:4},end:{line:40,column:5}},"4":{start:{line:6,column:30},end:{line:6,column:100}},"5":{start:{line:7,column:30},end:{line:7,column:90}},"6":{start:{line:9,column:8},end:{line:11,column:9}},"7":{start:{line:10,column:12},end:{line:10,column:69}},"8":{start:{line:13,column:31},end:{line:13,column:54}},"9":{start:{line:14,column:28},end:{line:14,column:81}},"10":{start:{line:15,column:33},end:{line:15,column:132}},"11":{start:{line:16,column:29},end:{line:16,column:122}},"12":{start:{line:17,column:27},end:{line:17,column:116}},"13":{start:{line:19,column:29},end:{line:19,column:31}},"14":{start:{line:20,column:8},end:{line:22,column:11}},"15":{start:{line:21,column:12},end:{line:21,column:49}},"16":{start:{line:24,column:27},end:{line:24,column:29}},"17":{start:{line:25,column:8},end:{line:27,column:11}},"18":{start:{line:26,column:12},end:{line:26,column:45}},"19":{start:{line:29,column:8},end:{line:36,column:11}},"20":{start:{line:38,column:8},end:{line:38,column:63}},"21":{start:{line:39,column:8},end:{line:39,column:65}},"22":{start:{line:43,column:0},end:{line:43,column:31}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:22},end:{line:3,column:23}},loc:{start:{line:3,column:42},end:{line:41,column:1}},line:3},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:27},end:{line:20,column:28}},loc:{start:{line:20,column:34},end:{line:22,column:9}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:25,column:25},end:{line:25,column:26}},loc:{start:{line:25,column:32},end:{line:27,column:9}},line:25}},branchMap:{"0":{loc:{start:{line:9,column:8},end:{line:11,column:9}},type:"if",locations:[{start:{line:9,column:8},end:{line:11,column:9}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:9}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5e37e2acd226cd9951347216acc2e4057461c1a8"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1fcz5r7m3d=function(){return actualCoverage;};}return actualCoverage;}cov_1fcz5r7m3d();const db=(cov_1fcz5r7m3d().s[0]++,require("../routes/db-config"));cov_1fcz5r7m3d().s[1]++;const pollAnalytics=async(req,res)=>{cov_1fcz5r7m3d().f[0]++;const pollId=(cov_1fcz5r7m3d().s[2]++,req.params.id);cov_1fcz5r7m3d().s[3]++;try{const[pollResults]=(cov_1fcz5r7m3d().s[4]++,await db.query('SELECT * FROM candidates WHERE poll_id = ?',[pollId]));const[pollDetails]=(cov_1fcz5r7m3d().s[5]++,await db.query('SELECT * FROM polls WHERE id = ?',[pollId]));cov_1fcz5r7m3d().s[6]++;if(pollDetails.length===0){cov_1fcz5r7m3d().b[0][0]++;cov_1fcz5r7m3d().s[7]++;return res.status(404).json({error:"Poll not found"});}else{cov_1fcz5r7m3d().b[0][1]++;}const pollVotesTable=(cov_1fcz5r7m3d().s[8]++,`votes${pollId}`.trim());const[pollVotes]=(cov_1fcz5r7m3d().s[9]++,await db.query(`SELECT * FROM \`${pollVotesTable}\``));const[timeSeriesData]=(cov_1fcz5r7m3d().s[10]++,await db.query(`SELECT vote_time, COUNT(*) AS votes FROM \`${pollVotesTable}\` GROUP BY vote_time`));const[genderData]=(cov_1fcz5r7m3d().s[11]++,await db.query(`SELECT gender, COUNT(*) AS count FROM \`${pollVotesTable}\` GROUP BY gender`));const[raceData]=(cov_1fcz5r7m3d().s[12]++,await db.query(`SELECT race, COUNT(*) AS count FROM \`${pollVotesTable}\` GROUP BY race`));const genderCounts=(cov_1fcz5r7m3d().s[13]++,{});cov_1fcz5r7m3d().s[14]++;genderData.forEach(row=>{cov_1fcz5r7m3d().f[1]++;cov_1fcz5r7m3d().s[15]++;genderCounts[row.gender]=row.count;});const raceCounts=(cov_1fcz5r7m3d().s[16]++,{});cov_1fcz5r7m3d().s[17]++;raceData.forEach(row=>{cov_1fcz5r7m3d().f[2]++;cov_1fcz5r7m3d().s[18]++;raceCounts[row.race]=row.count;});cov_1fcz5r7m3d().s[19]++;res.render("analytics",{poll:pollDetails[0],pollResults,pollVotes,timeSeriesData,genderData:genderCounts,raceData:raceCounts});}catch(error){cov_1fcz5r7m3d().s[20]++;console.error("Error fetching poll analytics:",error);cov_1fcz5r7m3d().s[21]++;res.status(500).json({error:"Internal server error"});}};cov_1fcz5r7m3d().s[22]++;module.exports=pollAnalytics;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMWZjejVyN20zZCIsImFjdHVhbENvdmVyYWdlIiwiZGIiLCJzIiwicmVxdWlyZSIsInBvbGxBbmFseXRpY3MiLCJyZXEiLCJyZXMiLCJmIiwicG9sbElkIiwicGFyYW1zIiwiaWQiLCJwb2xsUmVzdWx0cyIsInF1ZXJ5IiwicG9sbERldGFpbHMiLCJsZW5ndGgiLCJiIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwicG9sbFZvdGVzVGFibGUiLCJ0cmltIiwicG9sbFZvdGVzIiwidGltZVNlcmllc0RhdGEiLCJnZW5kZXJEYXRhIiwicmFjZURhdGEiLCJnZW5kZXJDb3VudHMiLCJmb3JFYWNoIiwicm93IiwiZ2VuZGVyIiwiY291bnQiLCJyYWNlQ291bnRzIiwicmFjZSIsInJlbmRlciIsInBvbGwiLCJjb25zb2xlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInBvbGxBbmFseXRpY3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGIgPSByZXF1aXJlKFwiLi4vcm91dGVzL2RiLWNvbmZpZ1wiKTtcclxuXHJcbmNvbnN0IHBvbGxBbmFseXRpY3MgPSBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IHBvbGxJZCA9IHJlcS5wYXJhbXMuaWQ7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IFtwb2xsUmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUICogRlJPTSBjYW5kaWRhdGVzIFdIRVJFIHBvbGxfaWQgPSA/JywgW3BvbGxJZF0pO1xyXG4gICAgICAgIGNvbnN0IFtwb2xsRGV0YWlsc10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUICogRlJPTSBwb2xscyBXSEVSRSBpZCA9ID8nLCBbcG9sbElkXSk7XHJcblxyXG4gICAgICAgIGlmIChwb2xsRGV0YWlscy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6IFwiUG9sbCBub3QgZm91bmRcIiB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBvbGxWb3Rlc1RhYmxlID0gYHZvdGVzJHtwb2xsSWR9YC50cmltKCk7XHJcbiAgICAgICAgY29uc3QgW3BvbGxWb3Rlc10gPSBhd2FpdCBkYi5xdWVyeShgU0VMRUNUICogRlJPTSBcXGAke3BvbGxWb3Rlc1RhYmxlfVxcYGApO1xyXG4gICAgICAgIGNvbnN0IFt0aW1lU2VyaWVzRGF0YV0gPSBhd2FpdCBkYi5xdWVyeShgU0VMRUNUIHZvdGVfdGltZSwgQ09VTlQoKikgQVMgdm90ZXMgRlJPTSBcXGAke3BvbGxWb3Rlc1RhYmxlfVxcYCBHUk9VUCBCWSB2b3RlX3RpbWVgKTtcclxuICAgICAgICBjb25zdCBbZ2VuZGVyRGF0YV0gPSBhd2FpdCBkYi5xdWVyeShgU0VMRUNUIGdlbmRlciwgQ09VTlQoKikgQVMgY291bnQgRlJPTSBcXGAke3BvbGxWb3Rlc1RhYmxlfVxcYCBHUk9VUCBCWSBnZW5kZXJgKTtcclxuICAgICAgICBjb25zdCBbcmFjZURhdGFdID0gYXdhaXQgZGIucXVlcnkoYFNFTEVDVCByYWNlLCBDT1VOVCgqKSBBUyBjb3VudCBGUk9NIFxcYCR7cG9sbFZvdGVzVGFibGV9XFxgIEdST1VQIEJZIHJhY2VgKTtcclxuXHJcbiAgICAgICAgY29uc3QgZ2VuZGVyQ291bnRzID0ge307XHJcbiAgICAgICAgZ2VuZGVyRGF0YS5mb3JFYWNoKHJvdyA9PiB7XHJcbiAgICAgICAgICAgIGdlbmRlckNvdW50c1tyb3cuZ2VuZGVyXSA9IHJvdy5jb3VudDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgcmFjZUNvdW50cyA9IHt9O1xyXG4gICAgICAgIHJhY2VEYXRhLmZvckVhY2gocm93ID0+IHtcclxuICAgICAgICAgICAgcmFjZUNvdW50c1tyb3cucmFjZV0gPSByb3cuY291bnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJlcy5yZW5kZXIoXCJhbmFseXRpY3NcIiwge1xyXG4gICAgICAgICAgICBwb2xsOiBwb2xsRGV0YWlsc1swXSxcclxuICAgICAgICAgICAgcG9sbFJlc3VsdHMsXHJcbiAgICAgICAgICAgIHBvbGxWb3RlcyxcclxuICAgICAgICAgICAgdGltZVNlcmllc0RhdGEsXHJcbiAgICAgICAgICAgIGdlbmRlckRhdGE6IGdlbmRlckNvdW50cyxcclxuICAgICAgICAgICAgcmFjZURhdGE6IHJhY2VDb3VudHNcclxuICAgICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIHBvbGwgYW5hbHl0aWNzOlwiLCBlcnJvcik7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogXCJJbnRlcm5hbCBzZXJ2ZXIgZXJyb3JcIiB9KTtcclxuICAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcG9sbEFuYWx5dGljcztcclxuIl0sIm1hcHBpbmdzIjoiZ3VGQWVZO0FBQUFBLGNBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsY0FBQSxHQWZaLEtBQU0sQ0FBQUUsRUFBRSxFQUFBRixjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLHFCQUFxQixDQUFDLEVBQUNKLGNBQUEsR0FBQUcsQ0FBQSxNQUUxQyxLQUFNLENBQUFFLGFBQWEsQ0FBRyxLQUFBQSxDQUFPQyxHQUFHLENBQUVDLEdBQUcsR0FBSyxDQUFBUCxjQUFBLEdBQUFRLENBQUEsTUFDdEMsS0FBTSxDQUFBQyxNQUFNLEVBQUFULGNBQUEsR0FBQUcsQ0FBQSxNQUFHRyxHQUFHLENBQUNJLE1BQU0sQ0FBQ0MsRUFBRSxFQUFDWCxjQUFBLEdBQUFHLENBQUEsTUFDN0IsR0FBSSxDQUNBLEtBQU0sQ0FBQ1MsV0FBVyxDQUFDLEVBQUFaLGNBQUEsR0FBQUcsQ0FBQSxNQUFHLEtBQU0sQ0FBQUQsRUFBRSxDQUFDVyxLQUFLLENBQUMsNENBQTRDLENBQUUsQ0FBQ0osTUFB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